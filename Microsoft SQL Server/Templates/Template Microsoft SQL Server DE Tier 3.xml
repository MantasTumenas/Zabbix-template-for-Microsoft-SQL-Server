<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.0</version>
    <date>2020-07-26T13:42:57Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Microsoft SQL Server DE Tier 3</template>
            <name>Template Microsoft SQL Server DE Tier 3</name>
            <description>Zabbix template for Microsoft SQL Server.&#13;
&#13;
Tested on Microsoft SQL Server 2012, 2014, 2016 and 2019. It may work with earlier versions, but some items (with missing performance counters) may be unsupported.&#13;
Tested on Zabbix 3.4.0. and 4.0.0. It may work with earlier versions, but some items (for example service.info[service,&lt;param&gt;]) may be unsupported.&#13;
&#13;
For Low Level Discovery to work additional scripts must be configured.&#13;
&#13;
Mantas Tumenas.&#13;
mantas.tumenas@gmail.com</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications/>
            <items/>
            <discovery_rules>
                <discovery_rule>
                    <name>SQL Server Instances Discovery</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>tier3.instances.mssql.discovery</key>
                    <delay>4h</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions/>
                    </filter>
                    <lifetime>14d</lifetime>
                    <description>SQL Server instances discovery with additional scripts lets discover Microsoft SQL Server instances.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Long running SQL Agent job</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,&quot;Error: 60000&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip]</key>
                            <delay>60s</delay>
                            <history>90d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>SQL Agent job has been running for more than 360 minutes.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Not synchronized logins or jobs</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,&quot;Error: 60001&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip]</key>
                            <delay>60s</delay>
                            <history>90d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Availability Groups replicas on server {#SQLINSTANCENAME} have not synchronized SQL server  logins or SQL Agent jobs.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Engine Critical Errors</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Microsoft SQL Server critical errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Could not allocate a new page</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1101|1105)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Msg 1101 or 1105 was logged in the Windows Application Event Log. These errors indicate that SQL server could not allocate a new page for database because of insufficient disk space in filegroup. Create the necessary space by dropping objects in the filegroup, adding additional files to the filegroup, or setting Autogrowth on for existing files in the filegroup.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Transaction log for database is full</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(9002)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>The transaction log for database is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Integrity Errors Part 1</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(211|427|602|603|606|608|610|806|823|824|825|829|832|855|856)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Microsoft SQL Server database integrity errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Integrity Errors Part 2</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1509|1522|3301|3302|3624|3864|4134|5029|5180|8440|8443|8444|8461|8646|9003|9015|9100|9655|9657|17065|17066|17067)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Microsoft SQL Server database integrity errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Backup Errors</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(2516|2517|3041|3134|3266|3313|3314|3315|3316|3417|3431|3443|3456|5173|5176|9004|14420|17208|17557|18204|18210|18273|35268|35269)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Microsoft SQL Server backup errors from Microsoft Windows Event Viewer.&#13;
&#13;
Event IDs are selected and reviewed from sys.messages table.&#13;
&#13;
SELECT *&#13;
FROM sys.messages&#13;
WHERE [text] LIKE '%backup%'&#13;
	AND language_id = 1033&#13;
	AND is_event_logged = 1&#13;
	AND severity &lt;&gt; 10&#13;
ORDER BY message_id ASC&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Backup</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME}: SQL Server hang condition</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17883|17884|17887|17888)$,,skip]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>2</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Msg 17883, 17884, 17887, or 17888 was logged in the Windows Application Event Log. These errors indicate that a hang condition was detected by SQL Server. This condition can result in application problems such as login timeouts, query timeouts, or execution failures. In some cases, this condition is isolated to a set of users based on a scheduler. In other cases the entire SQL Server might be affected. This error condition can often be the cause of a cluster failover.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Event Viewer</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Server: Service State</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>service.info[{#SQLINSTANCESERVICE}]</key>
                            <delay>60s</delay>
                            <history>45d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Monitors Microsoft SQL Server service state.&#13;
&#13;
Windows service status returned values:&#13;
0 - service running;&#13;
1 - service paused;&#13;
2 - service starting (start pending);&#13;
3 - service pausing (pause pending);&#13;
4 - service starting after pause (continue pending);&#13;
5 - service stopping (stop pending);&#13;
6 - service stopped;&#13;
7 - service state unknown;&#13;
255 - unable to get current service state.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>Windows service state</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Server Services</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1101|1105)$,,skip].logeventid(1101|1105)}=1</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1101|1105)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Could not allocate a new page</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Msg 1101 or 1105 was logged in the Windows Application Event Log. These errors indicate that SQL server could not allocate a new page for database because of insufficient disk space in filegroup. Create the necessary space by dropping objects in the filegroup, adding additional files to the filegroup, or setting Autogrowth on for existing files in the filegroup.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(2516|2517|3041|3134|3266|3313|3314|3315|3316|3417|3431|3443|3456|5173|5176|9004|14420|17208|17557|18204|18210|18273|35268|35269)$,,skip].logeventid(2516|2517|3041|3134|3266|3313|3314|3315|3316|3417|3431|3443|3456|5173|5176|9004|14420|17208|17557|18204|18210|18273|35268|35269)}=1 and {TRIGGER.VALUE}=0</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(2516|2517|3041|3134|3266|3313|3314|3315|3316|3417|3431|3443|3456|5173|5176|9004|14420|17208|17557|18204|18210|18273|35268|35269)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Backup Errors</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url>https://support.microsoft.com/en-us/help/224071/troubleshooting-sql-server-backup-and-restore-operations</url>
                            <status>0</status>
                            <priority>2</priority>
                            <description>INCIDENT REQUIRES MANUAL CLOSURE in the ZABBIX&#13;
Microsoft SQL Server backup errors from Microsoft Windows Event Viewer.&#13;
&#13;
Event IDs are selected and reviewed from sys.messages table.&#13;
&#13;
SELECT *&#13;
FROM sys.messages&#13;
WHERE [text] LIKE '%backup%'&#13;
	AND language_id = 1033&#13;
	AND is_event_logged = 1&#13;
	AND severity &lt;&gt; 10&#13;
ORDER BY message_id ASC&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,,,skip].strlen()}&gt;0 and {TRIGGER.VALUE}=0</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,,,skip].nodata({$EVENTLOGTIME})}=1 and {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Engine Critical Errors</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Microsoft SQL Server critical errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(211|427|602|603|606|608|610|806|823|824|825|829|832|855|856)$,,skip].logeventid(211|427|602|603|606|608|610|806|823|824|825|829|832|855|856)}=1</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(211|427|602|603|606|608|610|806|823|824|825|829|832|855|856)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Integrity Errors Part 1</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Microsoft SQL Server database integrity errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1509|1522|3301|3302|3624|3864|4134|5029|5180|8440|8443|8444|8461|8646|9003|9015|9100|9655|9657|17065|17066|17067)$,,skip].logeventid(1509|1522|3301|3302|3624|3864|4134|5029|5180|8440|8443|8444|8461|8646|9003|9015|9100|9655|9657|17065|17066|17067)}=1</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(1509|1522|3301|3302|3624|3864|4134|5029|5180|8440|8443|8444|8461|8646|9003|9015|9100|9655|9657|17065|17066|17067)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Database Integrity Errors Part 2</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Microsoft SQL Server database integrity errors from Microsoft Windows Event Viewer.&#13;
&#13;
Application (program) events. The Application log contains events logged by applications or programs. Events are classified as error, warning, or information, depending on the severity of the event. An error is a significant problem, such as loss of data. A warning is an event that isn't necessarily significant, but might indicate a possible future problem. An information event describes the successful operation of a program, driver, or service.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,&quot;Error: 60000&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip].logeventid(17061)}=1 and {TRIGGER.VALUE}=0</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,&quot;Error: 60000&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Long running SQL Agent job</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description>SQL Agent job has been running for more than 360 minutes.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,&quot;Error: 60001&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip].logeventid(17061)}=1 and {TRIGGER.VALUE}=0</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,&quot;Error: 60001&quot;,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17061)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Not synchronized logins or jobs</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Availability Groups replicas on server {#SQLINSTANCENAME} have not synchronized SQL server  logins or SQL Agent jobs.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17883|17884|17887|17888)$,,skip].logeventid(17883|17884|17887|17888)}=1</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(17883|17884|17887|17888)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: SQL Server hang condition</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Msg 17883, 17884, 17887, or 17888 was logged in the Windows Application Event Log. These errors indicate that a hang condition was detected by SQL Server. This condition can result in application problems such as login timeouts, query timeouts, or execution failures. In some cases, this condition is isolated to a set of users based on a scheduler. In other cases the entire SQL Server might be affected. This error condition can often be the cause of a cluster failover.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(9002)$,,skip].logeventid(9002)}=1</expression>
                            <recovery_mode>1</recovery_mode>
                            <recovery_expression>{Template Microsoft SQL Server DE Tier 3:eventlog[Application,,&quot;Information|Warning|Error|Critical&quot;,&quot;{#SQLINSTANCENAME}&quot;,^(9002)$,,skip].nodata({$EVENTLOGTIME})}=1 or {TRIGGER.VALUE}=0</recovery_expression>
                            <name>SQL Instance {#SQLINSTANCENAME}: Transaction log for database is full</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>The transaction log for database is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases. Solutions:&#13;
Create a backup and truncate the transaction logs.&#13;
Make the log space available.&#13;
Move log file to another disk drive.&#13;
Increase the size of log file.&#13;
Add another log file on a separate disk.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#1)}&gt;0 and {Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#1)}&lt;255 and {Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#2)}&gt;0 and {Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#2)}&lt;255 and {Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#3)}&gt;0 and {Template Microsoft SQL Server DE Tier 3:service.info[{#SQLINSTANCESERVICE}].last(#3)}&lt;255</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} SQL Server: Service State {ITEM.LASTVALUE}</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Monitors Microsoft SQL Server service state.&#13;
&#13;
Windows service status returned values:&#13;
0 - service running;&#13;
1 - service paused;&#13;
2 - service starting (start pending);&#13;
3 - service pausing (pause pending);&#13;
4 - service starting after pause (continue pending);&#13;
5 - service stopping (stop pending);&#13;
6 - service stopped;&#13;
7 - service state unknown;&#13;
255 - unable to get current service state.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
                <discovery_rule>
                    <name>SQL Server System Databases Discovery</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>tier3.sysdatabases.mssql.discovery</key>
                    <delay>4h</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions/>
                    </filter>
                    <lifetime>14d</lifetime>
                    <description>Microsoft SQL Server system database discovery with additional scripts lets discover Microsoft SQL Server system databases.&#13;
System databases here are: master, model, msdb, tempdb. Resource database is excluded from discovery and monitoring.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#SYSDBNAME}: Full Backup Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}]</key>
                            <delay>1h</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>System database full backup status from msdb.dbo.backupset.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database Backup status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#SYSDBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#SYSDBNAME}: Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>0 = Online&#13;
1 = Restoring&#13;
2 = Recovering: SQL Server 2008 through SQL Server 2017&#13;
3 = Recovery pending : SQL Server 2008 through SQL Server 2017&#13;
4 = Suspect &#13;
5 = Emergency: SQL Server 2008 through SQL Server 2017&#13;
6 = Offline: SQL Server 2008 through SQL Server 2017&#13;
7 = Copying : Azure SQL Database Active Geo-Replication &#13;
10 = Offline Secondary : Azure SQL Database Active Geo-Replication&#13;
21 = Mirrored, Secondary Synchronized&#13;
23 = Mirrored, Principal, Synchronized&#13;
25 = Mirrored, Secondary, Not Synchronized&#13;
26 = Mirrored, Principal, Not Synchronized&#13;
31 = Always On, Synchronized&#13;
35 = Always On, Not Synchronized&#13;
40 = Log Shipping, Standby / Read-Only&#13;
41 = Log Shipping, Restoring&#13;
42 = Log Shipping, Recovering</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#SYSDBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#1)}=1 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#2)}=1 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#3)}=1 or {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#1)}=2 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#2)}=2 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#3)}=2 or {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(0)}&gt;2 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(0)}&lt;11 or {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#1)}=25 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#2)}=25 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#3)}=25 or {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#1)}=26 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#2)}=26 and {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(#3)}=26 or {Template Microsoft SQL Server DE Tier 3:tier3.sysdatabase.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME}].last(0)}=35</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#SYSDBNAME}: Status {ITEM.LASTVALUE}</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>0 = Online&#13;
1 = Restoring&#13;
2 = Recovering: SQL Server 2008 through SQL Server 2017&#13;
3 = Recovery pending : SQL Server 2008 through SQL Server 2017&#13;
4 = Suspect &#13;
5 = Emergency: SQL Server 2008 through SQL Server 2017&#13;
6 = Offline: SQL Server 2008 through SQL Server 2017&#13;
7 = Copying : Azure SQL Database Active Geo-Replication &#13;
10 = Offline Secondary : Azure SQL Database Active Geo-Replication&#13;
21 = Mirrored, Secondary Synchronized&#13;
23 = Mirrored, Principal, Synchronized&#13;
25 = Mirrored, Secondary, Not Synchronized&#13;
26 = Mirrored, Principal, Not Synchronized&#13;
31 = Always On, Synchronized&#13;
35 = Always On, Not Synchronized&#13;
40 = Log Shipping, Standby / Read-Only&#13;
41 = Log Shipping, Restoring&#13;
42 = Log Shipping, Recovering</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=2</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup is older then {$SYSDBFTIME1} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>1</priority>
                            <description>System database full backup is older then {$SYSDBFTIME1} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=3</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup is older then {$SYSDBFTIME2} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description>System database full backup is older then {$SYSDBFTIME2} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup is older then {$SYSDBFTIME1} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=2</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=4</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup is older then {$SYSDBFTIME3} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>System database full backup is older then {$SYSDBFTIME3} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup is older then {$SYSDBFTIME2} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=3</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.sysdatabasefull.mssql.status[{#SQLINSTANCENAME},{#SYSDBNAME},{$SYSDBFTIME1},{$SYSDBFTIME2},{$SYSDBFTIME3}].last(,0)}=0</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} System Database {#SYSDBNAME}: Full Backup status unavailable</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>System database backup status from msdb.dbo.backupset is unavailable.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
                <discovery_rule>
                    <name>SQL Server Databases Discovery</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>tier3.userdatabases.mssql.discovery</key>
                    <delay>4h</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>2</evaltype>
                        <formula/>
                        <conditions/>
                    </filter>
                    <lifetime>14d</lifetime>
                    <description>SQL Server system database discovery with additional scripts lets discover Microsoft SQL Server user databases.&#13;
Distribution database is discovered as user database.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}]</key>
                            <delay>1h</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>User database differential backup status from msdb.dbo.backupset.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database Backup status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#DBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}]</key>
                            <delay>1h</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>User database full backup status from msdb.dbo.backupset.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database Backup status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#DBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}]</key>
                            <delay>10m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>User database log backup status from msdb.dbo.backupset.</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database Backup status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#DBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Status</name>
                            <type>7</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}]</key>
                            <delay>5m</delay>
                            <history>45d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>0 = Online&#13;
1 = Restoring&#13;
2 = Recovering: SQL Server 2008 through SQL Server 2017&#13;
3 = Recovery pending : SQL Server 2008 through SQL Server 2017&#13;
4 = Suspect &#13;
5 = Emergency: SQL Server 2008 through SQL Server 2017&#13;
6 = Offline: SQL Server 2008 through SQL Server 2017&#13;
7 = Copying : Azure SQL Database Active Geo-Replication &#13;
10 = Offline Secondary : Azure SQL Database Active Geo-Replication&#13;
21 = Mirrored, Secondary Synchronized&#13;
23 = Mirrored, Principal, Synchronized&#13;
25 = Mirrored, Secondary, Not Synchronized&#13;
26 = Mirrored, Principal, Not Synchronized&#13;
31 = Always On, Synchronized&#13;
35 = Always On, Not Synchronized&#13;
40 = Log Shipping, Standby / Read-Only&#13;
41 = Log Shipping, Restoring&#13;
42 = Log Shipping, Recovering</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap>
                                <name>SQL Database status</name>
                            </valuemap>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>SQL {#SQLINSTANCENAME} Database {#DBNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=12 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup is older then {$UDBDTIME1} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>1</priority>
                            <description>Database differential backup status is older then {$UDBDTIME1} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=13 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup is older then {$UDBDTIME2} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description/>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup is older then {$UDBDTIME1} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=12 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=14 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup is older then {$UDBDTIME3} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database differential backup status is older then {$UDBDTIME3} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup is older then {$UDBDTIME2} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=13 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasediff.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBDTIME1},{$UDBDTIME2},{$UDBDTIME3}].last(,0)}=0 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Diff Backup status unavailable</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database differential backup status from msdb.dbo.backupset is unavailable.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=7 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup is older then {$UDBFTIME1} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>1</priority>
                            <description>Database full backup status is older then {$UDBFTIME1} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=8 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup is older then {$UDBFTIME2} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description>Database full backup status is older then {$UDBFTIME2} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup is older then {$UDBFTIME1} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=7 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=9 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup is older then {$UDBFTIME3} hours</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database full backup status is older then {$UDBFTIME3} hours. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup is older then {$UDBFTIME2} hours</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=8 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabasefull.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBFTIME1},{$UDBFTIME2},{$UDBFTIME3}].last(,0)}=0 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Full Backup status unavailable</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database full backup status from msdb.dbo.backupset is unavailable.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=17 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup is older then {$UDBLTIME1} minutes</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>1</priority>
                            <description>Database log backup status is older then {$UDBLTIME1} minutes. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=18 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup is older then {$UDBLTIME2} minutes</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description>Database log backup status is older then {$UDBLTIME2} minutes. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup is older then {$UDBLTIME1} minutes</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=17 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=19 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup is older then {$UDBLTIME3} minutes</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database log backup status is older then {$UDBLTIME3} minutes. Status from msdb.dbo.backupset.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup is older then {$UDBLTIME2} minutes</name>
                                    <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=18 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                                    <recovery_expression/>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:backup.userdatabaselog.mssql.status[{#SQLINSTANCENAME},{#DBNAME},{$UDBLTIME1},{$UDBLTIME2},{$UDBLTIME3}].last(,0)}=0 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;21 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;23 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;40 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;41 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(,0)}&lt;&gt;42</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Log Backup status unavailable</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description>Database log backup status from msdb.dbo.backupset is unavailable.</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>Backup</tag>
                                    <value/>
                                </tag>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#1)}=1 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#2)}=1 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#3)}=1 or {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#1)}=2 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#2)}=2 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#3)}=2 or {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(0)}&gt;2 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(0)}&lt;11 or {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#1)}=25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#2)}=25 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#3)}=25 or {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#1)}=26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#2)}=26 and {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(#3)}=26 or {Template Microsoft SQL Server DE Tier 3:tier3.userdatabase.mssql.status[{#SQLINSTANCENAME},{#DBNAME}].last(0)}=35</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>SQL Instance {#SQLINSTANCENAME} Database {#DBNAME}: Status {ITEM.LASTVALUE}</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url>https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-states?view=sql-server-2017</url>
                            <status>0</status>
                            <priority>3</priority>
                            <description>0 = Online&#13;
1 = Restoring&#13;
2 = Recovering: SQL Server 2008 through SQL Server 2017&#13;
3 = Recovery pending : SQL Server 2008 through SQL Server 2017&#13;
4 = Suspect &#13;
5 = Emergency: SQL Server 2008 through SQL Server 2017&#13;
6 = Offline: SQL Server 2008 through SQL Server 2017&#13;
7 = Copying : Azure SQL Database Active Geo-Replication &#13;
10 = Offline Secondary : Azure SQL Database Active Geo-Replication&#13;
21 = Mirrored, Secondary Synchronized&#13;
23 = Mirrored, Principal, Synchronized&#13;
25 = Mirrored, Secondary, Not Synchronized&#13;
26 = Mirrored, Principal, Not Synchronized&#13;
31 = Always On, Synchronized&#13;
35 = Always On, Not Synchronized&#13;
40 = Log Shipping, Standby / Read-Only&#13;
41 = Log Shipping, Restoring&#13;
42 = Log Shipping, Recovering</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags>
                                <tag>
                                    <tag>SQL</tag>
                                    <value/>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
            </discovery_rules>
            <httptests/>
            <macros>
                <macro>
                    <macro>{$EVENTLOGTIME}</macro>
                    <value>28h</value>
                </macro>
                <macro>
                    <macro>{$SYSDBFTIME1}</macro>
                    <value>25</value>
                </macro>
                <macro>
                    <macro>{$SYSDBFTIME2}</macro>
                    <value>50</value>
                </macro>
                <macro>
                    <macro>{$SYSDBFTIME3}</macro>
                    <value>75</value>
                </macro>
                <macro>
                    <macro>{$UDBDTIME1}</macro>
                    <value>48</value>
                </macro>
                <macro>
                    <macro>{$UDBDTIME2}</macro>
                    <value>72</value>
                </macro>
                <macro>
                    <macro>{$UDBDTIME3}</macro>
                    <value>96</value>
                </macro>
                <macro>
                    <macro>{$UDBFTIME1}</macro>
                    <value>168</value>
                </macro>
                <macro>
                    <macro>{$UDBFTIME2}</macro>
                    <value>192</value>
                </macro>
                <macro>
                    <macro>{$UDBFTIME3}</macro>
                    <value>216</value>
                </macro>
                <macro>
                    <macro>{$UDBLTIME1}</macro>
                    <value>30</value>
                </macro>
                <macro>
                    <macro>{$UDBLTIME2}</macro>
                    <value>60</value>
                </macro>
                <macro>
                    <macro>{$UDBLTIME3}</macro>
                    <value>90</value>
                </macro>
            </macros>
            <templates/>
            <screens/>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>SQL Database Backup status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Backup status unavailable</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Backup is not older then 25 hours</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Backup is older then 25 hours</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Backup is older then 26 hours</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Backup is older then 27 hours</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Backup is not older then 7 days and 4 hours</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Backup is older then 7 days and 4 hours</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>Backup is older then 7 days and 6 hours</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>Backup is older then 7 days and 8 hours</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>Backup is not older then 25 hours</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>Backup is older then 25 hours</newvalue>
                </mapping>
                <mapping>
                    <value>13</value>
                    <newvalue>Backup is older then 26 hours</newvalue>
                </mapping>
                <mapping>
                    <value>14</value>
                    <newvalue>Backup is older then 27 hours</newvalue>
                </mapping>
                <mapping>
                    <value>16</value>
                    <newvalue>Backup is not older then 30 minutes</newvalue>
                </mapping>
                <mapping>
                    <value>17</value>
                    <newvalue>Backup is older then 30 minutes</newvalue>
                </mapping>
                <mapping>
                    <value>18</value>
                    <newvalue>Backup is older then 60 minutes</newvalue>
                </mapping>
                <mapping>
                    <value>19</value>
                    <newvalue>Backup is older then 90 minutes</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SQL Database status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Online</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Restoring</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Recovering</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Recovery pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Suspect</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Emergency</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Offline</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Copying</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>Offline secondary</newvalue>
                </mapping>
                <mapping>
                    <value>21</value>
                    <newvalue>Mirrored, Secondary Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>22</value>
                    <newvalue>Mirrored, Synchronizing</newvalue>
                </mapping>
                <mapping>
                    <value>23</value>
                    <newvalue>Mirrored, Principal, Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>25</value>
                    <newvalue>Mirrored, Secondary, Not Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>26</value>
                    <newvalue>Mirrored, Principal, Not Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>31</value>
                    <newvalue>AlwaysOn, Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>35</value>
                    <newvalue>AlwaysOn, Not Synchronized</newvalue>
                </mapping>
                <mapping>
                    <value>40</value>
                    <newvalue>Log Shipping, Standby / Read-Only</newvalue>
                </mapping>
                <mapping>
                    <value>41</value>
                    <newvalue>Log Shipping, Restoring</newvalue>
                </mapping>
                <mapping>
                    <value>42</value>
                    <newvalue>Log Shipping, Recovering</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Windows service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Running</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Paused</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Start pending</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Pause pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Continue pending</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Stop pending</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Stopped</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>No such service</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
